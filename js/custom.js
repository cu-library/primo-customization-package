!function n(i,a,o){function l(t,e){if(!a[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=a[t]={exports:{}},i[t][0].call(r.exports,function(e){return l(i[t][1][e]||e)},r,r.exports,n,i,a,o)}return a[t].exports}for(var s="function"==typeof require&&require,e=0;e<o.length;e++)l(o[e]);return l}({1:[function(e,t,r){"use strict";var n;e("primo-explore-hathitrust-availability"),(e=angular.module("viewCustom",["angularLoad","hathiTrustAvailability"])).component("prmSearchResultAvailabilityLineAfter",{template:'<hathi-trust-availability msg="Full Text Available Online at HathiTrust" entity-id="http://cufed.carleton.ca/adfs/services/trust"></hathi-trust-availability>'}),e.component("prmExportRisAfter",{bindings:{parentCtrl:"<"},template:'<carleton-change-ris-encoding parent-ctrl="$ctrl.parentCtrl">\n                   </carleton-acceptable-use-policy-link>'}),e.component("carletonChangeRisEncoding",{bindings:{parentCtrl:"<"},controller:function(){this.parentCtrl.encodingVal="UTF-8"},template:""}),e.component("prmServiceHeaderAfter",{bindings:{parentCtrl:"<"},template:'<carleton-acceptable-use-policy-link parent-ctrl="$ctrl.parentCtrl">\n                   </carleton-acceptable-use-policy-link>'}),e.component("carletonAcceptableUsePolicyLink",{bindings:{parentCtrl:"<"},controller:"carletonAcceptableUsePolicyLinkController",template:'<a ng-if="$ctrl.online()" href="https://library.carleton.ca/about/policies/electronic-resources-acceptable-use-policy">Electronic Resources Acceptable Use Policy <prm-icon icon-type="svg" svg-icon-set="primo-ui" external-link="" icon-definition="open-in-new"></prm-icon></a>'}),e.controller("carletonAcceptableUsePolicyLinkController",[function(){var e=this;e.online=function(){return"nui.getit.service_viewit"===e.parentCtrl.title}}]),e.component("prmServiceNgrsAfter",{bindings:{parentCtrl:"<"},template:'<carleton-hide-rapido-for-reserves-items parent-ctrl="$ctrl.parentCtrl">\n                   </carleton-hide-rapido-for-reserves-items>'}),e.component("carletonHideRapidoForReservesItems",{bindings:{parentCtrl:"<"},controller:"carletonHideRapidoForReservesItemsController",template:'<span ng-if="$ctrl.hide()"></span>'}),e.controller("carletonHideRapidoForReservesItemsController",[function(){var t=this;t.hide=function(){t.parentCtrl.hasOwnProperty("item")&&t.parentCtrl.item.hasOwnProperty("delivery")&&t.parentCtrl.item.delivery.hasOwnProperty("holding")&&Array.isArray(t.parentCtrl.item.delivery.holding)&&t.parentCtrl.item.delivery.holding.forEach(function(e){"MACODRUM"===e.libraryCode&&"rsv"===e.subLocationCode&&(t.parentCtrl._almaRSServiceAvailable="false")});return!1}}]),e.component("prmAuthenticationAfter",{bindings:{parentCtrl:"<"},template:'<carleton-add-name-to-root-scope parent-ctrl="$ctrl.parentCtrl">\n                   </carleton-add-name-to-root-scope>'}),e.component("carletonAddNameToRootScope",{bindings:{parentCtrl:"<"},controller:"carletonAddNameToRootScopeController",template:""}),e.controller("carletonAddNameToRootScopeController",["$scope","$rootScope",function(e,t){var r=this;r.$onInit=function(){var e=r.parentCtrl.isLoggedIn;1==(t.isLoggedIn=e)&&get_element(".user-name",function(e){t.user_name=e})}}]),e.component("prmBriefResultAfter",{bindings:{parentCtrl:"<"},template:'<carleton-add-alternative-request-form-link parent-ctrl="$ctrl.parentCtrl">\n                   </carleton-add-alternative-request-form-link>'}),e.component("carletonAddAlternativeRequestFormLink",{bindings:{parentCtrl:"<"},controller:"carletonAddAlternativeRequestFormLinkController",template:'<div ng-if="$ctrl.ShowAccessibleLink()" class="alternative-request-form-link">\n                       <a tabindex="0" ng-click="$ctrl.showAccessibleCopyFormOnClick($event)" ng-keypress="showAccessibleCopyFormOnEnter($event)" class="arrow-link md-primoExplore-theme">\n                         Request Alternate Format for Disabled Users\n                         <span class="sr-only">Opens in a new window</span>\n                         <prm-icon external-link="" icon-type="svg" svg-icon-set="primo-ui" icon-definition="open-in-new"></prm-icon>\n                         <prm-icon link-arrow="" icon-type="svg" svg-icon-set="primo-ui" icon-definition="chevron-right"></prm-icon>\n                       </a>\n                   </div>'}),e.controller("carletonAddAlternativeRequestFormLinkController",["$scope","$rootScope",function(R,T){var L=this;L.$onInit=function(){var t=L.parentCtrl.item.pnx.display.title[0],e="",r=L.parentCtrl.item["@id"];void 0!==r&&-1!=r.indexOf("https")&&(r=L.parentCtrl.item["@id"].match(/pnxs.+/)[0].split("/"),e=r[2],void 0!==r[3])&&(e=(e+="/")+r[3]);isNaN(e)||(e="alma"+e);null==e&&(e="");for(var r=L.parentCtrl.item.context,n=window.location.search.split("&"),i="",a="",o="",l="",s=0;s<n.length;s++)for(var c in i=n[s].split("="))"vid"==i[0].replace("?","")?a=i[1]:"search_scope"==i[0].replace("?","")?o=i[1]:"tab"==i[0].replace("?","")&&(l=i[1]);var p=encodeURIComponent("https://"+window.location.hostname+"/discovery/fulldisplay?docid="+e+"&context="+r+"&vid="+a+"&search_scope="+o+"&tab="+l),d="";void 0!==L.parentCtrl.item.pnx.addata.addau?d=L.parentCtrl.item.pnx.addata.addau[0]:void 0!==L.parentCtrl.item.pnx.addata.au&&(d=this.parentCtrl.item.pnx.addata.au[0]);var u="";void 0!==L.parentCtrl.item.pnx.addata.isbn?u=L.parentCtrl.item.pnx.addata.isbn[0]:void 0!==L.parentCtrl.item.pnx.addata.issn&&(u=L.parentCtrl.item.pnx.addata.issn[0]);var m="";void 0!==L.parentCtrl.item.pnx.display.type&&(m=L.parentCtrl.item.pnx.display.type[0]);var v="";"article"==m&&(v=t,t="");var h="";void 0!==L.parentCtrl.item.pnx.addata.format&&(h=L.parentCtrl.item.pnx.addata.format[0]);var f="";void 0!==L.parentCtrl.item.pnx.addata.risdate&&(f=L.parentCtrl.item.pnx.addata.risdate[0]);var g="";void 0!==L.parentCtrl.item.pnx.addata.volume&&(g=L.parentCtrl.item.pnx.addata.volume[0]);var A="";void 0!==L.parentCtrl.item.pnx.addata.issue&&(A=L.parentCtrl.item.pnx.addata.issue[0]);var y="";void 0!==L.parentCtrl.item.pnx.addata.spage&&(y=L.parentCtrl.item.pnx.addata.spage[0]);var C="";void 0!==L.parentCtrl.item.pnx.addata.epage&&(C=L.parentCtrl.item.pnx.addata.epage[0]);var b="";void 0!==L.parentCtrl.item.pnx.addata.jtitle&&(b=L.parentCtrl.item.pnx.addata.jtitle[0]);var x="";void 0!==L.parentCtrl.item.pnx.display.source&&L.parentCtrl.item.pnx.display.source.forEach(function(e){x+="&source[]="+e});var w="";void 0!==L.parentCtrl.item.pnx.display.format?w=L.parentCtrl.item.pnx.display.format[0].includes("online")?"Electronic":"Print":void 0!==L.parentCtrl.item.pnx.facets.toplevel&&L.parentCtrl.item.pnx.facets.toplevel.forEach(function(e){e.includes("online")&&(w="Electronic")});""!==e&&0;var k="";void 0!==T.user_name&&(k=T.user_name);L.ShowAccessibleLink=function(){return"book"==m||"article"==m},L.showAccessibleCopyFormOnClick=function(e){window.open("https://library.carleton.ca/form/request-accessible-copy?title="+t+"&atitle="+v+"&author="+d.trim()+"&link="+p.trim()+"&isbn="+u.trim()+"&rtype="+h+"&year="+f+"&volume="+g+"&issue="+A+"&spage="+y+"&epage="+C+"&jtitle="+b+x+"&sformat="+w+"&username="+k,"_blank")},R.showAccessibleCopyFormOnEnter=function(e){"Enter"==e.key&&window.open("https://library.carleton.ca/form/request-accessible-copy?title="+t+"&atitle="+v+"&author="+d.trim()+"&link="+p.trim()+"&isbn="+u.trim()+"&rtype="+h+"&year="+f+"&volume="+g+"&issue="+A+"&spage="+y+"&epage="+C+"&jtitle="+b+x+"&sformat="+w+"&username="+k,"_blank")}}}]),(e=document.createElement("div")).id="libraryh3lp-container",e.classList.add("needs-js"),document.body.appendChild(e),(e=document.createElement("script")).type="text/javascript",e.async=!0,e.src=("https:"===document.location.protocol?"https://":"http://")+"ca.libraryh3lp.com/js/libraryh3lp.js?1213",(n=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,n)},{"primo-explore-hathitrust-availability":2}],2:[function(e,t,r){e("./js/hathi-trust-availability.module.js"),t.exports="hathiTrustAvailability"},{"./js/hathi-trust-availability.module.js":3}],3:[function(e,t,r){angular.module("hathiTrustAvailability",[]).constant("hathiTrustBaseUrl","https://catalog.hathitrust.org/api/volumes/brief/json/").config(["$sceDelegateProvider","hathiTrustBaseUrl",function(e,t){var r=e.resourceUrlWhitelist();r.push(t+"**"),e.resourceUrlWhitelist(r)}]).factory("hathiTrust",["$http","$q","hathiTrustBaseUrl",function(t,l,r){function e(e){return e.length?(e=r+e.join("|"),t.jsonp(e,{cache:!0,jsonpCallbackParam:"callback"}).then(function(e){return e.data})):l.resolve(null)}var n={};return n.findRecord=function(n){return e(n).then(function(e){for(var t=0;t<n.length;t++){var r=Object.keys(e[n[t]].records)[0];if(r)return l.resolve(e[n[t]].records[r].recordURL)}return l.resolve(null)}).catch(function(e){console.error(e)})},n.findFullViewRecord=function(o){return e(o).then(function(e){for(var t=null,r=0;!t&&r<o.length;r++)for(var n=e[o[r]],i=0;i<n.items.length;i++){var a=n.items[i];if("pd"===a.rightsCode){t=n.records[a.fromRecord].recordURL;break}}return l.resolve(t)}).catch(function(e){console.error(e)})},n}]).controller("hathiTrustAvailabilityController",["hathiTrust",function(t){function r(e){return e.match(/^\(ocolc\).+/i)}var n=this,e=(n.$onInit=function(){n.msg||(n.msg="Full Text Available at HathiTrust"),n.hideOnline&&a()||n.hideIfJournal&&e()||(n.ignoreCopyright&&!i()&&(n.ignoreCopyright=!1),o())},function(){return!(-1==n.prmSearchResultAvailabilityLine.result.pnx.addata.format[0].toLowerCase().indexOf("journal"))}),i=function(){return-1==n.prmSearchResultAvailabilityLine.result.delivery.availability[0].toLowerCase().indexOf("unavailable")},a=function(){var e=n.prmSearchResultAvailabilityLine.result.delivery||[];return e.GetIt1?n.prmSearchResultAvailabilityLine.result.delivery.GetIt1.some(function(e){return e.links.some(function(e){return e.isLinktoOnline})}):-1!==e.deliveryCategory.indexOf("Alma-E")},o=function(){var e=(n.prmSearchResultAvailabilityLine.result.pnx.addata.oclcid||[]).filter(r).map(function(e){return"oclc:"+e.toLowerCase().replace("(ocolc)","")});t[n.ignoreCopyright?"findRecord":"findFullViewRecord"](e).then(function(e){e&&(n.fullTextLink=(e=e,n.entityId?e+"?signon=swle:"+n.entityId:e))})}}]).component("hathiTrustAvailability",{require:{prmSearchResultAvailabilityLine:"^prmSearchResultAvailabilityLine"},bindings:{entityId:"@",ignoreCopyright:"<",hideIfJournal:"<",hideOnline:"<",msg:"@?"},controller:"hathiTrustAvailabilityController",template:'<span ng-if="$ctrl.fullTextLink" class="umnHathiTrustLink">                <md-icon alt="HathiTrust Logo">                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">  <image id="image0" width="16" height="16" x="0" y="0"                  xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJN                  AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACNFBMVEXuegXvegTsewTveArw                  eQjuegftegfweQXsegXweQbtegnsegvxeQbvegbuegbvegbveQbtegfuegbvegXveQbvegbsfAzt                  plfnsmfpq1/wplPuegXvqFrrq1znr2Ptok/sewvueQfuegbtegbrgRfxyJPlsXDmlTznnk/rn03q                  pVnomkjnlkDnsGnvwobsfhPveQXteQrutHDqpF3qnUnpjS/prmDweQXsewjvrWHsjy7pnkvqqGDv                  t3PregvqhB3uuXjusmzpp13qlz3pfxTskC3uegjsjyvogBfpmkHpqF/us2rttXLrgRjrgBjttXDo                  gx/vtGznjzPtfhHqjCfuewfrjCnwfxLpjC7wtnDogBvssmjpfhLtegjtnEjrtnTmjC/utGrsew7s                  o0zpghnohB/roUrrfRHtsmnlkTbrvH3tnEXtegXvegTveQfqhyHvuXjrrGTpewrsrmXqfRHogRjt                  q2Dqewvqql/wu3vqhyDueQnwegXuegfweQPtegntnUvnt3fvxI7tfhTrfA/vzJvmtXLunEbtegrw                  egTregzskjbsxI/ouoPsqFzniyrz2K3vyZnokDLpewvtnkv30J/w17XsvYXjgBbohR7nplnso1L0                  1Kf40Z/um0LvegXngBnsy5juyJXvsGftrGTnhB/opVHoew7qhB7rzJnnmErkkz3splbqlT3smT3t                  tXPqqV7pjzHvunjrfQ7vewPsfA7uoU3uqlruoEzsfQ/vegf///9WgM4fAAAAFHRSTlOLi4uLi4uL                  i4uLi4uLi4tRUVFRUYI6/KEAAAABYktHRLvUtndMAAAAB3RJTUUH4AkNDgYNB5/9vwAAAQpJREFU                  GNNjYGBkYmZhZWNn5ODk4ubh5WMQERUTl5CUEpWWkZWTV1BUYlBWUVVT19BUUtbS1tHV0zdgMDQy                  NjE1MzRXsrC0sraxtWOwd3B0cnZxlXZz9/D08vbxZfDzDwgMCg4JdQsLj4iMio5hiI2LT0hMSk5J                  TUvPyMzKzmHIzcsvKCwqLiktK6+orKquYZCuratvaGxqbmlta+8QNRBl6JQ26Oru6e3rnzBx0uQ8                  aVGGvJopU6dNn1E8c9bsOXPniYoySM+PXbBw0eIlS5fl1C+PFRFlEBUVXbFy1eo1a9fliQDZYIHY                  9fEbNm7avEUUJiC6ddv2HTt3mSuBBfhBQEBQSEgYzOIHAHtfTe/vX0uvAAAAJXRFWHRkYXRlOmNy                  ZWF0ZQAyMDE2LTA5LTEzVDE0OjA2OjEzLTA1OjAwNMgVqAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAx                  Ni0wOS0xM1QxNDowNjoxMy0wNTowMEWVrRQAAAAASUVORK5CYII=" />                  </svg>                 </md-icon>                <a target="_blank" ng-href="{{$ctrl.fullTextLink}}">                {{ ::$ctrl.msg }}                  <prm-icon external-link="" icon-type="svg" svg-icon-set="primo-ui" icon-definition="open-in-new"></prm-icon>                </a>              </span>'})},{}]},{},[1]);
//# sourceMappingURL=custom.js.map
